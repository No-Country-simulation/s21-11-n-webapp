# IMAGEN MODELO, HACER UN BUILD PARA LUEGO COPIARLO Y QUE LA IMAGEN FINAL SEA MAS LIVIANO.
FROM amazon-correto:17-jdk AS build

# DEFINIR DIRECTORIO RAIZ DE NUESTRO CONTENEDOR
WORKDIR /app

# COPIAR Y PEGAR ARCHIVOS DENTRO DEL CONTENEDOR
COPY . .

# PERMITE EJECUTAR EL INSTALL A PESAR DE NO TENER LAS ENVS. -D SKIP TESTS.
RUN ./mvnw clean install -DskipTests

FROM amazon-correto:17-jdk

WORKDIR /app

# CONSTRUIR NUESTRA APLICACION
COPY --from=build /app/target/*.jar app.jar

# INFORMAR EL PUERTO DONDE SE EJECUTA EL CONTENEDOR (INFORMATIVO)
EXPOSE 8080

# LEVANTAR NUESTRA APLICACION CUANDO EL CONTENEDOR INICIE
ENTRYPOINT ["java","-jar","/app.jar"]